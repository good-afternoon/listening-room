THREE.DDSLoader=function(r){THREE.CompressedTextureLoader.call(this,r),this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(r,a){function e(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}var t={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=e("DXT1"),n=e("DXT3"),m=e("DXT5"),i=e("ETC1"),p=new Int32Array(r,0,31);if(542327876!==p[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),t;if(4&!p[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),t;var E,s=p[21],u=!1;switch(s){case o:E=8,t.format=THREE.RGB_S3TC_DXT1_Format;break;case n:E=16,t.format=THREE.RGBA_S3TC_DXT3_Format;break;case m:E=16,t.format=THREE.RGBA_S3TC_DXT5_Format;break;case i:E=8,t.format=THREE.RGB_ETC1_Format;break;default:if(!(32===p[22]&&16711680&p[23]&&65280&p[24]&&255&p[25]&&4278190080&p[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)}(s)),t;u=!0,E=64,t.format=THREE.RGBAFormat}t.mipmapCount=1,131072&p[2]&&!1!==a&&(t.mipmapCount=Math.max(1,p[7]));var d=p[28];if(t.isCubemap=!!(512&d),t.isCubemap&&(!(1024&d)||!(2048&d)||!(4096&d)||!(8192&d)||!(16384&d)||!(32768&d)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),t;t.width=p[4],t.height=p[3];for(var c=p[1]+4,T=t.isCubemap?6:1,h=0;h<T;h++)for(var D=t.width,f=t.height,C=0;C<t.mipmapCount;C++){if(u)R=(H=function(r,a,e,t){for(var o=e*t*4,n=new Uint8Array(r,a,o),m=new Uint8Array(o),i=0,p=0,E=0;E<t;E++)for(var s=0;s<e;s++){var u=n[p],d=n[++p],c=n[++p],T=n[++p];p++,m[i]=c,m[++i]=d,m[++i]=u,m[++i]=T,i++}return m}(r,c,D,f)).length;else var R=Math.max(4,D)/4*Math.max(4,f)/4*E,H=new Uint8Array(r,c,R);var S={data:H,width:D,height:f};t.mipmaps.push(S),c+=R,D=Math.max(D>>1,1),f=Math.max(f>>1,1)}return t};